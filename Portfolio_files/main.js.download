!function(a){"use strict";angular.module("ck-editor-angular-app-internal",[]);try{angular.module("ck-editor-angular-translations")}catch(b){angular.module("ck-editor-angular-translations",["pascalprecht.translate"])}angular.module("ck-editor-angular-app",["ck-editor-angular-app-internal","ck-editor-angular-translations","ck-editor-angular-preload","wixTextEditor","wixTextEditor.plugins"]).config(["wixTextEditorPluginsManagerProvider",function(a){a.configure({shimCKEditor:!0,shimExternalPlugins:!0})}]),function(){function b(b,d){var e=a;this.shimCKEditor=function(){d.shimCKEditor&&c(e)},this.shimExternalPlugins=function(){d.shimExternalPlugins&&d.externalPlugins.forEach(function(a){e.plugins.addExternal(a,d.externalPluginsBasePath+a+"/plugin.js")})}}function c(a){d(a,a.style.prototype),e(a.dom.selection.prototype),a.dom.element.prototype.isEmptyInlinePasteRemoveable=function(){if(!a.dtd.$removeEmpty[this.getName()])return!1;for(var b=this.getChildren(),c=0,d=b.count();d>c;c++){var e=b.getItem(c);if(!(e.type==a.NODE_ELEMENT&&e.data("cke-bookmark")||(e.type!=a.NODE_ELEMENT||e.isEmptyInlinePasteRemoveable())&&(e.type!=a.NODE_TEXT||e.getText()&&e.isWhiteSpace())))return!1}return!0},a.dom.text.prototype.isWhiteSpace=function(){return/^[\s\ufeff\u200b]*$/.test(this.getText())}}function d(a,b){b.findMatchingElements=function(b){var c=[];switch(this.type){case a.STYLE_BLOCK:b.block&&this.checkElementRemovable(b.block,!0)&&c.push(b.block),b.blockLimit&&this.checkElementRemovable(b.blockLimit,!0)&&c.push(b.blockLimit);break;case a.STYLE_OBJECT:case a.STYLE_INLINE:for(var d,e=b.elements,f=0;f<e.length;f++)if(d=e[f],this.type!==a.STYLE_INLINE||d!==b.block&&d!==b.blockLimit){if(this.type===a.STYLE_OBJECT){var g=d.getName();if(!("string"==typeof this.element?g===this.element:g in this.element))continue}this.checkElementRemovable(d,!0)&&c.push(d)}}return c}}function e(a){a.ignoreFillingCharRemoveOnSelectionChange=angular.noop,a.resumeFillingCharRemoveOnSelectionChange=angular.noop}angular.module("wixTextEditor.plugins",[]),angular.module("wixTextEditor.plugins").provider("wixTextEditorPluginsManager",function(){var a={shimCKEditor:!1,shimExternalPlugins:!1,externalPluginsBasePath:"",externalPlugins:["wixstylecmndshelper","wixpreservestyle","wixParser","wixlink","wixpaste","styleCommands"]};this.configure=function(b){angular.extend(a,b||{})},this.$get=["$window",function(c){return new b(c,a)}]}).run(["$window","wixTextEditorPluginsManager",function(a,b){b.shimCKEditor(),b.shimExternalPlugins()}])}(),function(){angular.module("wixTextEditor",["wixTextEditor.plugins"])}(),function(){function a(a){return{modelName:a,defaultValue:"",convertToCK:c,convertFromCK:c}}function b(a){return{modelName:a,defaultValue:!1,convertToCK:function(a){return a?d.CONSTANTS_CKEDITOR_TRISTATE_ON:d.CONSTANTS_CKEDITOR_TRISTATE_OFF},convertFromCK:function(a){return a===d.CONSTANTS_CKEDITOR_TRISTATE_ON}}}function c(a){return a}var d={CONSTANTS_CKEDITOR_TRISTATE_ON:1,CONSTANTS_CKEDITOR_TRISTATE_OFF:2,CONSTANTS_SELECTION_TYPES:{TEXT:"text"}},e={bold:b("isBold"),italic:b("isItalic"),underline:b("isUnderline"),numberedlist:b("isNumberedList"),bulletedlist:b("isBulletList"),removeFormat:b("removeFormat"),indent:b("indent"),outdent:b("outdent"),justifyleft:b("isJustifyLeft"),justifycenter:b("isJustifyCenter"),justifyright:b("isJustifyRight"),justifyblock:b("isJustifyBoth"),bidiltr:b("isLTR"),bidirtl:b("isRTL"),lineHeight:a("lineHeight"),letterSpacing:a("letterSpacing"),backColor:{modelName:"colorHighlight",defaultValue:"",convertToCK:function(a){return a&&""!==a?a:d.CONSTANTS_CKEDITOR_TRISTATE_OFF},convertFromCK:function(a){return a===d.CONSTANTS_CKEDITOR_TRISTATE_OFF?"":a}}};angular.module("wixTextEditor").constant("textEditorConsts",d).constant("textEditorCommands",e)}(),function(){function b(b,e,f,g,h){function i(i,j,k,l){function m(){b.updateEditorCss(i.editorId)}function n(a,b){return function(c){var d=b(c.sender.state,i.editorId);E.safeModelUpdate(function(){E[a]=d})}}function o(){var a=b.getCommands();return _.isEmpty(F.WIX_COMMANDS_OFF)?a:_.omit(a,F.WIX_COMMANDS_OFF)}function p(){_.forEach(o(),function(a,b){var c=G.getCommand(b),d=a.modelName,e=a.convertFromCK;c.on("state",n(d,e))})}function q(a){var c=_.includes||_.contains;return!a||c(a,b.getSelectionData(i.editorId).type)}function r(a,b,c){var d=G.getCommand(a);return function(e){if(q(c)){var f=b(e);d&&f&&d.state!==f&&G.execCommand(a,f)}}}function s(){_.forEach(o(),function(a,b){var c;c=a.createWatcher?a.createWatcher(i.editorId):r(b,a.convertToCK,a.applyOnTypes),i.$watch("ctrl."+a.modelName,function(a){c(a),z()})})}function t(){var a=G.container.getClientRect();E.measurements.editor.height=a.height,E.measurements.editor.width=a.width,E.measurements.editor.offsetLeft=G.container.$.offsetLeft,E.measurements.editor.offsetTop=G.container.$.offsetTop}function u(a,b){return"W-TEXT-EDITOR"===b.nodeName}function v(a){var b=jQuery(a.target);return b.is(u)||b.parents().is(u)||b.parents().is(".cke_dialog")}function w(){var a=G.getSelection();a&&(a.removeAllRanges(),G.selectionChange(!0)),z()}function x(a){v(a)||w();var b=$(a.target);return b.is(".button,.popup-btn,.button-with-text,.arrow,.region-btn")?!1:((b.closest(".cke_editable").length||b.is(".toolbar-row,.button-group"))&&h.hideAll(),!0)}function y(){var a=b.getConflictedStylesInSelection(E.editorId),c=_.includes||_.contains;_.forOwn(d,function(b,d){E.conflicted[d]=c(a,b)})}function z(){if(!E.isIgnoreSelectionChanges()){var a=b.getSelectionData(i.editorId);E.safeModelUpdate(function(){E.measurements.selection=a.area,E.selectionType=a.type,E.isSelectedImageFullSize=!1,y()})}}function A(){G.on("selectionCheck",function(){z()}),H.on(I,x)}function B(){_.forEach(o(),function(a,b){var c=G.getCommand(b);E[a.modelName]=a.convertFromCK(c.state,i.editorId)})}function C(){G.on("change",function(){b.updateTextModelIfNeeded(i.editorId,i.textDataObj)&&(j.trigger("auto-save",i.textDataObj.text),D&&D.$setDirty(),i.$eval(i.onTextChange))})}var D=l[0],E=l[1],F=_.cloneDeep(c);F.removePlugins="resize",k.contentsCss&&(F.contentsCss=[k.contentsCss]),"false"===k.inline&&(F.plugins+=",autogrow",F.autoGrow_minHeight=300,F.autoGrow_onStartup=!0),angular.extend(F,i.config||{});var G=a["false"!==k.inline?"inline":"replace"](j.find("textarea")[0],F),H=jQuery(e),I="mousedown";b.addCKEditor(i.editorId,G),G.once("instanceReady",function(){m(),b.initFontsHandler(i.editorId,E),b.initText(i.editorId,i.textDataObj,function(){}),G.config.startupFocus!==!1&&G.focus(),B(),p(),s(),A(),G.on("afterPaste",function(){G.editable().scrollIntoView()}),C(),G.__instanceReady__=!0,f(i.onInstanceReady)}),G.once("contentDom",function(){t(),f(i.onContentDomReady)});var J=_.once(function(){H.off(I,x),b.DestroyEditor(i.editorId)});j.on("$destroy",J),i.$on("$destroy",J);var K=function(a){i.isExpanded=a};i.isExpanded=g.isExpanded(),g.addOnToolbarExpandListener(K),i.$on("$destroy",function(){g.removeOnToolbarExpandListener(K)})}return{restrict:"E",require:["?^form","wTextEditor"],controller:"wixTextEditorController",controllerAs:"ctrl",transclude:!0,template:'<div ng-transclude class="wix-text-editor" ng-class="{expanded: isExpanded}"></div><textarea class="wix-text-editor"></textarea>',scope:{textDataObj:"=wixText",onTextChange:"&",onInstanceReady:"&",onContentDomReady:"&",config:"=",editorId:"@"},link:i}}b.$inject=["wTextEditorService","$window","$timeout","wToolbarExpanderService","wDropdownManager"];var c={customConfig:"",language:"en",title:!1,disableDragAndDrop:!0,disableObjectResizing:!0,disableNativeSpellChecker:!0,allowedContent:!0,fillEmptyBlocks:!0,forceEnterMode:!0,toolbar:"wixtexteditor",toolbar_wixtexteditor:[],fullPage:!1,enterMode:a.ENTER_P,ignoreEmptyParagraph:!1,clipboard_defaultContentType:"text",stylesMap:{},colorsMap:{},bgColorsMap:{}};!function(){function a(){return 1}var b=["h1","h2","h3","h4","h5","h6","address","div","p"];c.format_tags=b.join(";"),c.format_tags_map=_.zipObject(b,b.map(a)),b.forEach(function(a){c["format_"+a]={element:a}})}(),c.removePlugins="elementspath,link,scayt,menubutton,contextmenu,tabletools,magicline,resize",c.plugins=["wixstylecmndshelper","styleCommands","bidi","indent","indentlist","indentblock","clipboard","enterkey","entities","htmlwriter","justify","list","pastefromword","pastetext","removeformat","selectall","sourcearea","undo","wixlink","wixParser","wixpaste","wysiwygarea","lineutils","table"].join(",");var d={isBold:"font-weight",isUnderline:"text-decoration",isItalic:"font-style",isJustifyLeft:"text-align",isJustifyCenter:"text-align",isJustifyRight:"text-align",isJustifyBoth:"text-align",isLTR:"direction",isRTL:"direction",fontSize:"font-size",lineHeight:"line-height",letterSpacing:"letter-spacing"};angular.module("wixTextEditor").directive("wTextEditor",b)}(),function(){function b(b,d,e,f){function g(a){return a.startContainer.getUniqueId()===a.endContainer.getUniqueId()&&a.startOffset===a.endOffset}function h(a){var b=a&&a.getNative()?a.getRanges()[0]:null;return b?g(b):!0}function i(a){var b=a.getNative();if(b){var c;if(b.getRangeAt)c=b.getRangeAt(0);else try{c=b.createRange()}catch(d){}return c?c.getBoundingClientRect():void 0}}function j(a,b){var c={top:0,center:0,height:0};if(b){c.top=a.$.offsetTop+b.top;var d=a.$.offsetLeft+b.left,e=b.width;c.center=d+e/2,c.height=b.height}return c}function k(a){return c[a]||(c[a]={}),c[a]}function l(a){delete c[a]}function m(a){return k(a).editor}function n(a,b){k(a).currentData=b}function o(a){return k(a).currentData}function p(a){try{a()}catch(c){b.error(c)}}function q(a,c,d){var e=0,f=setInterval(function(){e++,a()?clearInterval(f):e>=c&&(clearInterval(f),b.debug("Failed to destroy CKEDITOR. Repeat limit reached!"))},d)}function r(a){var b=$(m(a).container.$);return{style:"normal",variant:"normal",weight:"normal",size:b.css("font-size"),lineHeight:"1.4em",fontFamily:b.css("font-family"),color:"#0099FF"}}function s(a){var b=a.getCommand(A);return b.state}function t(a){var b=a.getCommand(B);return b.state}function u(a){var b=a.getCommand(C);return b.state}function v(a,b,c,e,f,g,h){return{name:a,command:{modelName:b,defaultValue:h,createWatcher:function(b){var f=m(b);return function(h){var i=r(b)[c],j=e(h);j===i&&(j=d.CONSTANTS_CKEDITOR_TRISTATE_OFF),angular.isDefined(j)&&j!==g(f)&&f.execCommand(a,j)}},convertFromCK:function(a,b){var e=a;return e===d.CONSTANTS_CKEDITOR_TRISTATE_OFF&&(e=r(b)[c]),f(e,a,b)}}}}function w(b){for(var c,d=b.getChildren(),e=[],f=d.count();f--;)c=d.getItem(f),c.type===a.NODE_ELEMENT?e=e.concat(w(c)):c.type===a.NODE_TEXT&&e.push(c);return e}function x(a){return!!_.find(a,function(a){return!!a})}function y(){return function(a){var b=a.data.name;if("fontFamily"===b){var c=a.data.commandData;if(c&&c!==d.CONSTANTS_CKEDITOR_TRISTATE_OFF){var e=c.replace(/"/g,"").split(",");_.forEach(e,function(a){f.loadFont(a)})}}}}this.getSelectionData=function(a){var b={},c=m(a);if(c){var e=c.getSelection();e&&(h(e)||(b.area=j(c.container,i(e)),b.type=d.CONSTANTS_SELECTION_TYPES.TEXT))}return b},this.getCKEditor=function(a){return k(a).editor},this.addCKEditor=function(a,b){k(a).editor=b},this.DestroyEditor=function(a){var b=m(a);p(function(){b.focusManager.blur(!0)}),p(function(){var a=b.getSelection();a&&a.removeAllRanges()}),q(function(){return b.__instanceReady__&&(l(a),p(function(){b.removeAllListeners(),b.destroy(!0)})),b.__instanceReady__},50,200)},this.initText=function(a,b,c){var d=m(a);d.setData(null===b.text?"":b.text,function(){d.resetUndo(),angular.isFunction(c)&&c()}),n(a,d.getData())},this.enableModelUpdates=!0,this.updateTextModelIfNeeded=function(a,b){var c=m(a),d=o(a),e=c.getData();return this.enableModelUpdates&&d!==e?(b.text=e,n(a,e),!0):!1},this.checkSelection=function(a){var b=m(a);b.fire("selectionCheck")};var z="wixLink",A="fontSize",B="fontFamily",C="foreColor",D={linkCommand:{name:z,command:{modelName:"link",defaultValue:null,createWatcher:function(){return function(){}},convertFromCK:function(a){return a===d.CONSTANTS_CKEDITOR_TRISTATE_OFF?"":a}}},fontSizeCommand:v(A,A,"size",function(a){return a+"px"},function(a){return parseInt(a)},s,16),fontFamilyCommand:v(B,B,"fontFamily",function(a){return a},function(a,b,c){var e;if(b===d.CONSTANTS_CKEDITOR_TRISTATE_OFF){var f=m(c);e=$(f.container.$).css("font-family")||b}else e=a;return e&&_.isString(e)&&(e=e.split(",").map(function(a){return a.replace(/["']/g,"").trim()}).map(function(a){return a.replace(/.*[^\w\d\-].*/,"'$&'")}).join(", ")),e},t,2),fontColorCommand:v(C,"colorFont","color",function(a){return""===a?d.CONSTANTS_CKEDITOR_TRISTATE_OFF:a},function(a){return a===d.CONSTANTS_CKEDITOR_TRISTATE_OFF?"":a},u,d.CONSTANTS_CKEDITOR_TRISTATE_OFF)};this.getCommands=function(){var a={};return _.forEach(D,function(b){a[b.name]=b.command}),_.assign(a,e)},this.updateEditorCss=function(b){var c=m(b);c.config.stylesMap={},c.config.colorsMap={},c.config.bgColorsMap={},a.plugins.wixParser.resetTheMaps(c.config)},this.getConflictedStylesInSelection=function(a){var b=m(a);return b&&b.plugins.styleCommands?b.plugins.styleCommands.getConflictedStylesInSelection(b):[]},this.setSelection=function(a,b,c){if(3===arguments.length){for(var d=m(a),e=w(d.editable()),f=d.createRange(),g=0,h=e.length-1;h>-1;h--){var i=e[h].getText().length+g;b>=g&&i>b&&f.setStart(e[h],b-g),c>=g&&i>c&&f.setEnd(e[h],c-g),g=i}x(f)&&d.getSelection().selectRanges([f])}},this.initFontsHandler=function(a){var b=m(a);b.on("beforeCommandExec",y(b),this)}}b.$inject=["$log","textEditorConsts","textEditorCommands","wTextFontsService"];var c={};angular.module("wixTextEditor").service("wTextEditorService",b)}(),function(){function a(a){function e(a,e,f,g){var h=!0,i={},j=a.find(".popup-inner-content"),k=a.find(".popup-btn"),l=k.children();return e=e||function(){},i.editorId=f,i.popupId=g,i.showPopup=function(){h||(j.show(),a.trigger(c,a),l.addClass(b),k.addClass(b),h=!0,e())},i.hidePopup=function(){h&&(j.hide(),a.trigger(d,k),l.removeClass(b),k.removeClass(b),h=!1)},i.getNextIsVisibleState=function(){return!h},i.hidePopup(),i}var f={},g=0;this.hideAll=function(){var a=_.invokeMap||_.invoke;a(_.values(f),"hidePopup")},this.togglePopupById=function(b){if(f.hasOwnProperty(b)){var c=f[b],d=c.getNextIsVisibleState();_.values(f).forEach(function(a){a!==c&&a.hidePopup()}),d?c.showPopup():c.hidePopup()}else a.error("Invalid popup ID.")},this.closeManager=function(a){_.values(f).filter(function(b){return b.editorId===a}).forEach(function(a){a.hidePopup(),delete f[a.popupId]})},this.registerPopup=function(a,b,c){var d=c+g++,h=e(a,b,c,d);return f[d]=h,d},this.SHOW_DROPDOWN_EVENT=c,this.HIDE_DROPDOWN_EVENT=d}a.$inject=["$log"],angular.module("wixTextEditor").service("wDropdownManager",a);var b="active",c="showdropdown",d="hidedropdown"}(),function(){function a(a,b,c,d,e){this.dropdown=function(){var a=function(a,b,c,d){a.textEditorCtrl=d},c=function(a,c,f){function g(){var a=k.position();j.css({top:h(k,a),left:a.left+k.width()/2-j.width()/2+"px"}),m()}function h(a,b){return"top"===f.placement?b.top-j.height()-a.height()-5+"px":b.top+a.height()+5+"px"}function i(b,c){void 0!==b&&(a.imgClass&&l.removeClass(a.imgClass),a.imgClass=b,l.addClass(a.imgClass)),void 0!==c&&(a.btnText=c,l.text(a.btnText))}var j=c.find(".popup-inner-content"),k=c.find(".popup-btn"),l=c.find(".button .img-icon"),m=a.onOpen||angular.noop,n=!1,o=b.registerPopup(c,g,a.textEditorCtrl.editorId);if(a.updateEvent&&""!==a.updateEvent){var p=a.textEditorCtrl.genEventName(a.updateEvent);d.register(p,function(a){i(a.imageClass,a.buttonText)})}a.extraClass&&c.addClass(a.extraClass),i(a.imgClass,a.btnText),g(),a.togglePopup=function(){n||b.togglePopupById(o)},a.$on("wix-text-toolbar-close",b.hideAll),a.$on("$destroy",function(){b.closeManager(a.textEditorCtrl.editorId)});var q=_.partial(e(a.disableExpr),a.$parent);a.disableExpr&&a.$watch(q,function(a){a?(c.addClass("disabled"),k.addClass("disabled"),n=!0):(c.removeClass("disabled"),k.removeClass("disabled"),n=!1)})};return{pre:a,post:c}},this.dualStateToolbarBtn=function(){var a=function(a,b,c,d){a.textEditorCtrl=d},b=function(a,b){function c(){if(a.updateEvent&&""!==a.updateEvent){var b=a.textEditorCtrl.genEventName(a.updateEvent);d.notify(b,{imageClass:a.extraClass})}}var f=!1,g=function(b){return arguments.length&&(a.textEditorCtrl[a.targetName]=b,b&&c()),i?a.textEditorCtrl[a.targetName]:a.customTarget},h=angular.isFunction(a.customClick)?a.customClick:angular.noop,i=angular.isDefined(a.targetName);if(i?a.$watch(function(){return g()},g):(g=h,h=angular.noop),b.addClass(a.extraClass||""),a.btnText&&b.text(a.btnText),a.btnPress=function(){if(!f){var b=!g();a.textEditorCtrl.setIgnoreSelectionChange(!1),g(b),h(b)}},a.disableIf){var j=_.partial(e(a.disableIf),a.textEditorCtrl);a.$watch(j,function(a){angular.isDefined(a)&&(f=a,a?b.addClass("disabled"):b.removeClass("disabled"))})}};return{pre:a,post:b}},this.numSlider=function(){function b(b,e,f,g){function h(a){var c=b.unit||"";return String(a)+c}function i(a,b){var c={};if(!o()){var e=h(b);c={buttonText:e,value:b}}d.notify(u,c),angular.isDefined(a)&&q.css({top:a+s+"px"})}function j(a){return 1===arguments.length&&a!==j()&&g.safeModelUpdate(function(){g[b.targetName]=a}),g[b.targetName]}function k(a){v.onOffsetChange(a.pageY-t)}function l(){m(),b.textEditorCtrl.setIgnoreSelectionChange(!1)}function m(){a.off("mousemove",k),a.off("mouseup",l)}function n(c){c.preventDefault(),t=c.pageY-v.getIndicatorOffset(),a.on("mousemove",k),a.on("mouseup",l),b.textEditorCtrl.setIgnoreSelectionChange(!0)}function o(){return g.conflicted[b.targetName]}var p=e.find(".slider-line"),q=e.find(".indicator"),r=c.calcBoundaries(b,p.height(),q.height()),s=q.height()/2,t=0,u=g.genEventName(b.targetName),v=new c.Slider(r,j,i),w=v.onModelChange.bind(v);p.addClass(b.extraClass||""),q.on("mousedown",n),b.$watch(function(){return j()},w),b.$watch(o,function(){i(void 0,v.getModelValue())}),b.$on("wix-text-toolbar-close",m)}var e=function(a,b,c,d){a.textEditorCtrl=d};return{pre:e,post:b}},this.button=function(){var a=function(a,b,c,d){a.textEditorCtrl=d},c=function(a,c){c.addClass(a.extraClass||""),c.addClass(a.btnImgClass||""),a.btnText&&c.text(a.btnText);var d=a.textEditorCtrl[a.operationName],e=angular.isFunction(d)?d:angular.noop,f=angular.isFunction(a.customClick)?a.customClick:angular.noop;a.click=function(){e(),f(),b.hideAll()}};return{pre:a,post:c}}}a.$inject=["$document","wDropdownManager","wNumSliderUtils","wViewReflector","$parse"],angular.module("wixTextEditor").service("wTextEditorLinker",a)}(),function(){function a(){var a={},b={};this.register=function(c,d){a[c]=a[c]||[];var e=_.includes||_.contains;if(!e(a[c],d)){a[c].push(d);var f=b[c];angular.isDefined(f)&&d(f.args)}},this.notify=function(c,d){b[c]={args:d},_.forEach(a[c],function(a){a(d)})}}angular.module("wixTextEditor").service("wViewReflector",a)}(),function(){function a(){function a(a,b){var c=(Math.round(a/b)*b).toFixed(Math.ceil(-Math.log10(b)));return Number(c)}function c(a,b,c){return Math.min(Math.max(a,b),c)}function d(b,c){var d=1-b/(1*c.maxOffset),e=d*c.range+c.min;return a(e,c.resolution)}function e(a,b){var d=c(a,b.min,b.max)-b.min,e=1-d/(1*b.range);return Math.round(e*b.maxOffset)}function f(a,b){var f=a,g=d(a,b);this.getRaw=function(){return f},this.setRaw=function(a){f=c(a,0,b.maxOffset),g=d(f,b)},this.getAsModelValue=function(){return g},this.setAsModelValue=function(a){g=a,f=e(a,b)}}this.calcBoundaries=function(a,c,d){var e=["min","max","default","resolution"],f={};return e.forEach(function(b){f[b]=Number(a[b])||0}),f.range=f.max-f.min,f.resolution=f.resolution||b,f.maxOffset=Math.floor(c-d),f},this.Slider=function(a,b,c){function d(){var a=e.getRaw(),d=e.getAsModelValue();b(d),c(a,d)}var e=new f(0,a);this.onModelChange=function(a){e.setAsModelValue(a),c(e.getRaw(),e.getAsModelValue())},this.onValueChange=function(a){e.setAsModelValue(a),d()},this.onOffsetChange=function(a){e.setRaw(a),d()},this.getIndicatorOffset=e.getRaw.bind(e),this.getModelValue=e.getAsModelValue.bind(e),this.onValueChange(a["default"])}}angular.module("wixTextEditor").service("wNumSliderUtils",[a]);var b=.01;Math.log10||(Math.log10=function(a){return Math.log(a)/Math.LN10})}(),function(){function a(){var a=null;this.useProvider=function(b){a=b},this.getFontByCss=function(b){return a?a.getFontByCss(b):null},this.loadFont=function(b){a&&a.loadFont(b)},this.getFonts=function(){return a?a.getFonts():{}}}angular.module("wixTextEditor").service("wTextFontsService",a)}(),function(){function a(){return{restrict:"E",require:"^wTextEditor",transclude:!0,replace:!0,scope:{selectionType:"@"},template:'<div class="toolbar clearfix {{selectionType}}" ng-transclude></div>',link:{pre:function(a,b,c,d){a.wixTextEditor=d,a.selectionType=a.selectionType||"text"}},controller:["$scope","$element",function(a,b){this.initComponent=function(){var c=b.find(".toolbar")[0];b.click(function(b){b.target===c&&a.wixTextEditor.setIgnoreSelectionChange(!1)})},this.initComponent()}]}}angular.module("wixTextEditor").directive("wTextEditorToolbar",a)}(),function(){function a(a){return{restrict:"E",require:"^wTextEditor",replace:!0,transclude:!0,template:'<div class="button" ng-class="{active: (textEditorCtrl[targetName] && !textEditorCtrl.conflicted[targetName]) }" ng-click="btnPress()" ng-transclude></div>',scope:{targetName:"@",customClick:"=",extraClass:"@",btnText:"@",updateEvent:"@",customName:"=",disableIf:"@"},link:a.dualStateToolbarBtn()}}a.$inject=["wTextEditorLinker"],angular.module("wixTextEditor").directive("wDualStateToolbarBtn",a)}(),function(){function a(a){return{restrict:"E",require:"^wTextEditor",replace:!0,scope:{targetName:"@",isValidFunc:"=",min:"@wMin",max:"@wMax",step:"@wStep"},template:'<input type="number" min="{{min}}" max="{{max}}" step="{{step}}" ng-model="input.target" ng-change="input.change()">',link:{pre:function(a,b,c,d){a.textEditorCtrl=d},post:function(b,c){function d(){c.focus(),a(g)}function e(a){return a.preventDefault(),!1}function f(){c.on(k,e),l=!0}function g(){c.off(k,e),l=!1}function h(c){return arguments.length&&h()!==c&&(b.textEditorCtrl.setIgnoreSelectionChange(!0),i.safeModelUpdate(function(){i[j]=c}),a(function(){b.textEditorCtrl.setIgnoreSelectionChange(!1,!0)})),i[j]}var i=b.textEditorCtrl,j=b.targetName,k="keydown",l=!1,m=_.isFunction(b.isValidFunc)?b.isValidFunc:_.constant(!0);b.$watch(function(){return h()},function(a){b.input.target=parseFloat(a)}),b.input={target:h(),change:function(){var c=b.input.target;m(c)&&h(c),l||(f(),a(d))}}}}}}a.$inject=["$timeout"],angular.module("wixTextEditor").directive("wNumInput",a)}(),function(){function a(a,b){function c(a,b){return _.mapValues(a,function(a){return a+b})}function d(d,f){function g(){j.focus(),j.select()}var h,i,j=f.find("input").hide();j.on("keypress",function(b){var c=b.which||b.keyCode;13===c&&(b.preventDefault(),a.hideAll())}),f.on(a.SHOW_DROPDOWN_EVENT,function(){h||(h=f.find(".popup-btn"),i=h.parents(".toolbar"));var a=h.offset(),d=i.offset(),k={width:h.width()+2*e,height:h.height()+2*e,top:a.top-d.top,left:a.left-d.left};j.css(c(k,"px")).show(),b(g)}),f.on(a.HIDE_DROPDOWN_EVENT,function(){j.hide()})}var e=1;return{restrict:"E",require:"^wTextEditor",scope:!0,template:'<w-num-input class="font-size-input so-input-medium" min="4" max="500" step="1" target-name="fontSize" is-valid-func="isValidFunc"></w-num-input><w-toolbar-dropdown extra-class="slider-line-dropdown" update-event="fontSize"><w-toolbar-num-slider min="4" max="50" default="16" resolution="1" unit="px" target-name="fontSize"></w-toolbar-num-slider></w-toolbar-dropdown>',link:{pre:function(a,b,c,d){b.addClass("font-size"),a.textEditorCtrl=d;var e=/^\d+$/;a.isValidFunc=function(a){if(e.test(a)){var b=_.parseInt(a);return b>=4&&500>=b}return!1}},post:d}}}a.$inject=["wDropdownManager","$timeout"],angular.module("wixTextEditor").directive("wToolbarFontSize",a)}(),function(){angular.module("wixTextEditor").directive("wToolbarStrike",["wTextEditorService","$timeout",function(a,b){return{restrict:"E",scope:{},require:"^wTextEditor",template:'<div class="button strike" ng-class="{active: isStriked}" ng-click="strike()"></div>',link:function(c,d,e,f){function g(a){a.getCommand("strike").on("state",function(a){c.isStriked=1===a.sender.state})}c.strike=function(){a.getCKEditor(f.editorId).execCommand("strike")},b(function(){var b=a.getCKEditor(f.editorId);b.__instanceReady__?g(b):b.once("instanceReady",function(){g(b)})})}}}]).directive("wToolbarBold",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isBold" extra-class="bold" ></w-dual-state-toolbar-btn>'}}).directive("wToolbarUnderline",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isUnderline" extra-class="underline" ></w-dual-state-toolbar-btn>'}}).directive("wToolbarNumberedList",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isNumberedList" extra-class="numbered-list" ></w-dual-state-toolbar-btn>'}}).directive("wToolbarBulletList",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isBulletList" extra-class="bullet-list" ></w-dual-state-toolbar-btn>'}}).directive("wToolbarItalic",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isItalic" extra-class="italic" ></w-dual-state-toolbar-btn>'}}).directive("wToolbarTextAlign",function(){return{restrict:"E",template:'<w-toolbar-dropdown img-class="text-align-left" update-event="textAlign"><w-dual-state-toolbar-btn target-name="isJustifyLeft" extra-class="text-align-left" update-event="textAlign" custom-name="text-alignment"></w-dual-state-toolbar-btn><w-dual-state-toolbar-btn target-name="isJustifyCenter" extra-class="text-align-center" update-event="textAlign" custom-name="text-alignment"></w-dual-state-toolbar-btn><w-dual-state-toolbar-btn target-name="isJustifyRight" extra-class="text-align-right" update-event="textAlign" custom-name="text-alignment"></w-dual-state-toolbar-btn><w-dual-state-toolbar-btn target-name="isJustifyBoth" extra-class="text-align-both" update-event="textAlign" custom-name="text-alignment"></w-dual-state-toolbar-btn></w-toolbar-dropdown>'}}).directive("wToolbarTextDir",function(){return{restrict:"E",template:'<w-toolbar-dropdown img-class="ltr" update-event="textDir"><w-toolbar-ltr></w-toolbar-ltr><w-toolbar-rtl></w-toolbar-rtl></w-toolbar-dropdown>'}}).directive("wToolbarRtl",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isRTL" extra-class="rtl" update-event="textDir"></w-dual-state-toolbar-btn>'}}).directive("wToolbarLtr",function(){return{restrict:"E",template:'<w-dual-state-toolbar-btn target-name="isLTR" extra-class="ltr" update-event="textDir"></w-dual-state-toolbar-btn>'}}).directive("wToolbarRemoveFormat",function(){return{restrict:"E",template:'<w-button btn-img-class="remove-format" custom-click="toggleRemoveFormat"></w-button>',require:"^wTextEditor",link:{pre:function(a,b,c,d){a.toggleRemoveFormat=function(){d.setFlagThenClearIt("removeFormat")}}}}}).directive("wToolbarIndent",function(){return{restrict:"E",template:'<w-button btn-img-class="indent-btn" custom-click="indent"></w-button>',require:"^wTextEditor",link:{pre:function(a,b,c,d){a.indent=function(){d.setFlagThenClearIt("indent")}}}}}).directive("wToolbarOutdent",function(){return{restrict:"E",template:'<w-button btn-img-class="outdent-btn" custom-click="outdent"></w-button>',require:"^wTextEditor",link:{pre:function(a,b,c,d){a.outdent=function(){d.setFlagThenClearIt("outdent")}}}}})}(),function(){function a(a){return{restrict:"E",require:"^wTextEditor",transclude:!0,templateUrl:"modules/wixTextEditor/directives/wixToolbarDropdownTemplate.html",scope:{btnText:"@",imgClass:"@",updateEvent:"@",extraClass:"@",noArrow:"@",onOpen:"&",target:"@",isWide:"@",disableExpr:"@"},link:a.dropdown()}}a.$inject=["wTextEditorLinker"],angular.module("wixTextEditor").directive("wToolbarDropdown",a)}(),function(){function a(a){return{restrict:"E",require:"^wTextEditor",controllerAs:"textEditorCtrl",replace:!1,template:'<div class="slider-line"><div class="indicator"></div></div>',scope:{targetName:"@",extraClass:"@",min:"@",max:"@","default":"@",resolution:"@",unit:"@"},link:a.numSlider()}}a.$inject=["wTextEditorLinker"],angular.module("wixTextEditor").directive("wToolbarNumSlider",a)}(),function(){function a(a){return{restrict:"E",require:"^wTextEditor",replace:!0,transclude:!0,template:'<div class="button" ng-click="click()" ng-transclude></div>',scope:{btnText:"@",btnImgClass:"@",operationName:"@",customClick:"=",extraClass:"@",tooltip:"@"},link:a.button()}}angular.module("wixTextEditor").directive("wButton",["wTextEditorLinker",a])}(),function(){function a(a){var b=a.which||a.keyCode;13===b&&a.preventDefault()}function b(){function b(b,c,d,e){b.wixTextEditor=e,c.on("keypress",a)}return{restrict:"E",require:"^wTextEditor",scope:{target:"@",placeholder:"@",tooltip:"@"},replace:!0,template:'<input type="text" pattern=".*\\S.*" placeholder="{{placeholder}}" ng-model="wixTextEditor[target]">',link:{pre:b}}}angular.module("wixTextEditor").directive("wInput",b)}(),function(){function a(a,b,c){function d(a){return a.replace(/"/g,"'").replace(/,/g,", ")}function e(a,b){return{labelForAutoComplete:a.displayName,value:d(a.cssFontFamily),label:"",imageClass:"font-family-option fonts-font-"+(b+1),spriteIndex:b}}function f(a){var b=a.spriteIndex;return e(a,b)}function g(a){var c=[{labelForAutoComplete:"Default",label:"Default",value:b.CONSTANTS_CKEDITOR_TRISTATE_OFF,imageClass:"font-family-option"}],d=_.flatten(_.map(h(a),f));return c.concat(d).filter(function(a){return-1!==a.spriteIndex})}function h(b){var c=a.getFonts(),d=_.isArray(c)?c:_.values(c);if(b){var e=b.split(","),f=_.includes||_.contains;return d.filter(function(a){return f(e,a.provider)})}return d}function i(a,b){var c=14;b.length>c&&(b=b.substring(0,c-2)+"..."),a.text(b)}return{restrict:"E",require:"^wTextEditor",template:'<w-writable-drop-down class="font-family font-family-dropdown" update-event="fontFamily" target="fontFamily" items="items" case-insensitive="true"/>',scope:!0,link:{pre:function(a,b,d,e){a.textEditorCtrl=e,a.items=g(d.provider);var f=a.textEditorCtrl.genEventName("fontFamily");c.register(f,function(c){if(_.has(c,"value")){var d=_.find(a.items,{value:c.value}),e=b.find(".button.popup-btn .img-icon");d&&i(e,d.labelForAutoComplete)}})}}}}a.$inject=["wTextFontsService","textEditorConsts","wViewReflector"],angular.module("wixTextEditor").directive("wFontFamily",a)}(),function(){function a(){return{restrict:"E",require:"^wTextEditor",scope:!0,template:'<w-list-drop-down icon-class="line-height" items="items" target="lineHeight" class="w-line-height" />',link:{pre:function(a,c,d,e){a.textEditorCtrl=e,a.items=b}}}}angular.module("wixTextEditor").directive("wLineHeight",a);var b=[{value:2,label:"Default"},{value:"0.5em",label:"0.5"},{value:"0.6em",label:"0.6"},{value:"0.7em",label:"0.7"},{value:"0.8em",label:"0.8"},{value:"0.9em",label:"0.9"},{value:"1em",label:"1"},{value:"1.1em",label:"1.1"},{value:"1.2em",label:"1.2"},{value:"1.3em",label:"1.3"},{value:"1.4em",label:"1.4"},{value:"1.5em",label:"1.5"},{value:"1.6em",label:"1.6"},{value:"1.7em",label:"1.7"},{value:"1.8em",label:"1.8"},{value:"1.9em",label:"1.9"},{value:"2em",label:"2"},{value:"2.25em",label:"2.25"},{value:"2.5em",label:"2.5"},{value:"2.75em",label:"2.75"},{value:"3em",label:"3"}]}(),function(){function a(){return{restrict:"E",require:"^wTextEditor",scope:!0,template:'<w-list-drop-down icon-class="letter-spacing" items="items" target="letterSpacing" class="w-letter-spacing" />',link:{pre:function(a,c,d,e){a.textEditorCtrl=e,a.items=b}}}}angular.module("wixTextEditor").directive("wLetterSpacing",a);var b=[{value:2,label:"Default"},{value:"-0.1em",label:"-0.1"},{value:"-0.05em",label:"-0.05"},{value:"0.0em",label:"0.0"},{value:"0.1em",label:"0.1"},{value:"0.2em",label:"0.2"},{value:"0.3em",label:"0.3"},{value:"0.4em",label:"0.4"},{value:"0.5em",label:"0.5"},{value:"0.6em",label:"0.6"
},{value:"0.7em",label:"0.7"},{value:"0.8em",label:"0.8"}]}(),function(){function a(a,b,c){var d=a[0]||a;if(!(b>=c))if(d.createTextRange){var e=d.createTextRange();e.collapse(!0),e.moveStart("character",b),e.moveEnd("character",c),e.select(),d.focus()}else d.setSelectionRange?(d.focus(),d.setSelectionRange(b,c)):"undefined"!=typeof d.selectionStart&&(d.selectionStart=b,d.selectionEnd=c,d.focus())}function b(b,c){var d=b.val().toLowerCase();b.val(c);var e=0===c.toLowerCase().indexOf(d)?d.length:0;a(b,e,c.length)}function c(a,b){return _.mapValues(a,function(a){return a+b})}function d(a,b){var c=a.children().eq(b).position();c&&a.scrollTop(a.scrollTop()+c.top-i)}function e(a,b){var c=a.toLowerCase();return _.findIndex(b,function(a){return 0===a.labelForAutoComplete.toLowerCase().indexOf(c)})}function f(a){var b=a.which||a.keyCode;13===b&&a.preventDefault()}function g(a,g,i){return{restrict:"E",require:"^wTextEditor",scope:{items:"=",updateEvent:"@",target:"@",isWide:"@",iconClass:"@",caseInsensitive:"="},template:'<input class="writeable-dd-input so-input-medium" type="text" ng-model="ddInputModel" ng-change="handleInputChange($event)"/><w-list-drop-down class="text-to-left" items="items" update-event="{{updateEvent}}" is-wide="{{isWide}}" display-target="{{displayTarget}}" target="{{target}}" case-insensitive="caseInsensitive">',link:{pre:function(a,b,c,d){a.textEditorCtrl=d},post:function(j,k){function l(a){angular.isDefined(a)&&a!==u&&(u=a,m(),t&&i.notify(t,{candidateItemIndex:u}))}function m(){g(function(){if(u>-1){var a=j.items[u];b(s,a.labelForAutoComplete)}})}function n(){s.focus(),s.select()}function o(){p&&q&&r||(p=k.find(".popup-btn"),q=p.parents(".toolbar"),r=k.find(".drop-down-scroll"))}var p,q,r,s=k.find("input").hide(),t=j.updateEvent&&j.textEditorCtrl.genEventName(j.updateEvent),u=-1;s.on("keypress",f),t&&i.register(t,function(a){l(a.candidateItemIndex)}),j.handleInputChange=function(){if(!_.isEmpty(j.ddInputModel)){var a=e(j.ddInputModel,j.items);a>=0&&(o(),d(r,a),l(a))}},k.on(a.SHOW_DROPDOWN_EVENT,function(){o();var a=p.offset(),b=q.offset(),d={width:p.width()+2*h,height:p.height()+2*h,top:a.top-b.top,left:a.left-b.left};s.css(c(d,"px")).show(),g(n)}),k.on(a.HIDE_DROPDOWN_EVENT,function(){s.hide()})}}}}g.$inject=["wDropdownManager","$timeout","wViewReflector"],angular.module("wixTextEditor").directive("wWritableDropDown",g);var h=0,i=20}(),function(){function a(a,b){if(!_.isEmpty(a)){var c=a.offset().top,d=b.offset().top,e=d>c,f=c+a.height()>b.height()+d,g=c-d+b.scrollTop(),h=g-(b.height()-a.height());e?b.scrollTop(g):f&&b.scrollTop(h)}}function b(a,b,c,d){var e=0;return angular.isDefined(a)&&a!==b&&(e=_.findIndex(c,function(b){return d===!0?(""+b.value).toLowerCase()===(""+a).toLowerCase():b.value===a})),e}function c(a,b){return angular.isNumber(a)&&a>=0&&a<_.size(b)}function d(b){function c(){return g||(g=b.find(".popup-btn")),g}function d(){c().addClass(j)}function e(){c().removeClass(j)}function f(c){h||(h=b.find(".drop-down-scroll")),i||(i=b.find(".dd-item")),a(i.eq(c),h)}var g,h,i,j="active";return{markDropdownAsActive:d,unmarkDropdownAsActive:e,scrollToItemByIndex:f}}function e(a,e,f,h){return{restrict:"E",require:"^wTextEditor",scope:{items:"=",target:"@",displayTarget:"@",isWide:"@",iconClass:"@",updateEvent:"@",caseInsensitive:"="},template:g,link:{pre:function(a,b,c,d){a.textEditorCtrl=d,a.selectedItemIndex=-1,a.candidateItemIndex=-1},post:function(g,i){function j(a){return angular.isDefined(a)&&1===arguments.length&&j()!==a&&(g.textEditorCtrl[g.target]=a),g.textEditorCtrl[g.target]}function k(){w&&f.notify(w,_.pick(g,["selectedItemIndex","candidateItemIndex"]))}function l(a){a!==g.selectedItemIndex&&(g.selectedItemIndex=a,k(),f.notify(x,{value:g.items[a].value}))}function m(a){a!==g.candidateItemIndex&&(g.candidateItemIndex=a,k())}function n(){m(g.selectedItemIndex),s.markDropdownAsActive(),s.scrollToItemByIndex(g.selectedItemIndex),u.on(t,r)}function o(){s.unmarkDropdownAsActive(),u.off(t,r)}function p(a){var b=g.candidateItemIndex+(a?-1:1);c(b,g.items)&&(m(b),s.scrollToItemByIndex(b))}function q(a){g.$apply(),a.stopPropagation()}function r(b){var c=b.keyCode||b.which,d=13===c,e=38===c,f=40===c,h=27===c;e||f?(p(e),q(b)):d?(g.selectItemAndClose(g.candidateItemIndex),q(b)):h&&(a.hideAll(),q(b))}var s=d(i),t="keydown",u=i.parents("body"),v=e.CONSTANTS_CKEDITOR_TRISTATE_OFF,w=g.updateEvent&&g.textEditorCtrl.genEventName(g.updateEvent),x=g.textEditorCtrl.genEventName(g.target);w&&f.register(w,function(a){h(function(){_.assign(g,_.pick(a,["selectedItemIndex","candidateItemIndex"]))})}),g.$watch(function(){return j()},function(a){if(angular.isDefined(a)){var d=b(a,v,g.items,g.caseInsensitive);c(d,g.items)&&l(d)}}),g.selectItemAndClose=function(b){c(b,g.items)&&(l(b),j(g.items[b].value)),a.hideAll()},g.setCandidateIndex=m,i.on(a.SHOW_DROPDOWN_EVENT,n),i.on(a.HIDE_DROPDOWN_EVENT,o),g.$on("$destroy",function(){i.off(a.SHOW_DROPDOWN_EVENT,n),i.off(a.HIDE_DROPDOWN_EVENT,o),u.off(t,r)})}}}}e.$inject=["wDropdownManager","textEditorConsts","wViewReflector","$timeout"],angular.module("wixTextEditor").directive("wListDropDown",e);var f='<div ng-repeat="item in items" class="{{\'dd-item \'}}"ng-class="{\'dd-selected-item\': $index === selectedItemIndex, \'dd-candidate-item\': candidateItemIndex === $index}" ng-click="selectItemAndClose($index);"ng-mouseenter="setCandidateIndex($index);"><span class="{{\'dd-item-label \' + item.imageClass}}">{{item.label || ""}}</span></div>',g='<w-toolbar-dropdown update-event="{{updateEvent}}" is-wide="{{isWide}}" img-class="{{iconClass}}" target="{{displayTarget}}"><div w-drop-down-scroll class="drop-down-scroll">'+f+"</div></w-toolbar-dropdown>"}(),function(){function a(a,b){return{restrict:"E",transclude:!0,scope:{customClick:"&"},template:d,link:function(c){c.toolbarExpanded=b.isExpanded(),c.toggleExpand=function(){c.toolbarExpanded=b.isExpanded(!c.toolbarExpanded),c.customClick({status:c.toolbarExpanded}),b.onToolbarExpand(c.toolbarExpanded),a.hideAll()}}}}function b(a){return{restrict:"E",replace:!0,transclude:!0,template:'<div ng-show="isExpanded" class="toolbar-expander-content" ng-transclude></div>',link:function(b){var c=function(a){b.isExpanded=a};b.isExpanded=a.isExpanded(),a.addOnToolbarExpandListener(c),b.$on("$destroy",function(){a.removeOnToolbarExpandListener(c)})}}}function c(){var a=!1,b=[];this.isExpanded=function(){return 1===arguments.length&&(a=arguments[0]),a},this.addOnToolbarExpandListener=function(a){b.push(a)},this.removeOnToolbarExpandListener=function(a){var c=b.indexOf(a);c>-1&&b.splice(c,1)},this.onToolbarExpand=function(a){b.forEach(function(b){b(a)})}}a.$inject=["wDropdownManager","wToolbarExpanderService"],b.$inject=["wToolbarExpanderService"],angular.module("wixTextEditor").directive("wToolbarExpander",a).directive("wToolbarExpandableContent",b).service("wToolbarExpanderService",c);var d='<div class="button popup-btn expand-link" ng-click="toggleExpand()"><div class="img-icon button-with-text">{{toolbarExpanded ? "CK.EDITOR.NG.COMMON.LESS" : "CK.EDITOR.NG.COMMON.MORE" | translate}}</div><symbol class="arrow"></symbol></div>'}(),function(){function a(a,b,c,d,e){function f(a){f._data||(f._data={queue:[],timerHandle:void 0}),a&&(f._data.queue.push(a),f.clearTimer(),f._data.timerHandle=e(f.flush))}var g=this;g.conflicted={fontSize:!1};var h=d.getCommands();_.forOwn(h,function(a){g[a.modelName]=a.defaultValue,g.conflicted[a.modelName]=!1}),g.measurements={isSelectedImageFullSize:!1,selection:void 0,editor:{width:0,height:0,offsetLeft:0},toolbar:{offsetTop:0,offsetLeft:0}},f.flush=function(){_.forEach(f._data.queue,function(a){a()}),f.clearTimer(),f._data={queue:[],timerHandle:void 0}},f.clearTimer=function(){f._data.timerHandle&&(e.cancel(f._data.timerHandle),f._data.timerHandle=void 0)},g.safeModelUpdate=function(a){f(a)},g.setFlagThenClearIt=function(a){g.safeModelUpdate(function(){g[a]=!0}),e(function(){g[a]=!1})},g.genEventName=function(b){return a.editorId+"#"+b},a.editorId=a.editorId||_.now().toString(32),g.editorId=a.editorId;var i=!1;g.setIgnoreSelectionChange=function(b,e){i=!!b,b||e||(c.hideAll(),d.checkSelection(a.editorId))},g.isIgnoreSelectionChanges=function(){return i},g.colorFont="",g.colorHighlight="",g.fontFamily=2,g.fontSize=16,g.lineHeight=2,g.letterSpacing=2,e(function(){g.fontFamily=b.css("font-family")||2,g.fontSize=parseInt(b.css("font-size"))||16}),g.getTextObject=function(){return a.textDataObj},g.initText=function(b){d.initText(a.editorId,b)},g.setSelection=function(b,c){d.setSelection(a.editorId,b,c)},g.enableModelUpdates=function(){d.enableModelUpdates=!0},g.disableModelUpdates=function(){d.enableModelUpdates=!1}}a.$inject=["$scope","$element","wDropdownManager","wTextEditorService","$timeout"],angular.module("wixTextEditor").controller("wixTextEditorController",a)}(),function(){function a(a,b){function c(a,c){a.stopPropagation(),b.setColor(c)}angular.extend(a,g),a.color=b.getColor();var d=angular.isFunction(a.onInitialized)?a.onInitialized:angular.noop;a.onInitialized=function(a){d(a),a.on("move.spectrum",c)}}function b(b,f,g){function h(h,i,j,k){function l(){b.hideAll()}function m(){return!!h.spectrum.isCustomize}function n(){u&&(h.wixTextEditor[h.modelName]=u[h.modelName])}function o(){u={},u[h.modelName]=angular.copy(h.wixTextEditor[h.modelName]),v=!1,w.setType({modelName:h.modelName,defaultVal:h.defaultVal}),x.refreshDom(),h.toggleCustomize(!1)}function p(a){function b(a){var b=h();if(a){for(_.pull(b,a);_.size(b)>=d;)b.shift();b.push(a)}j(b),g()}function g(){for(var b=h(),c=jQuery(i.find(".recent-colors")),f='<span title="{1}" data-color="{1}" class="sp-thumb-el sp-thumb-dark"><span class="sp-thumb-inner" style="background-color:{1};"></span></span>';_.size(b)<d;)b.unshift(e);b.reverse();var g=b.map(function(b){var c=jQuery(f.replace(/\{1}/g,b.replace("!","")));return b===e?c.addClass("placeholder"):c.click(function(){a.setColor(b)}),c});c.empty().append(g)}function h(){var a=f.localStorage;return _.compact((a[c]||"").split(";"))}function j(a){var b=f.localStorage;b[c]=a.join(";")}return{refreshDom:g,updateRecentWithNewColor:b}}function q(a,b,c){var d,e=this;this.getColor=function(){return b[d.modelName]||d.defaultVal},this.setColor=function(a){_.isObject(a)&&angular.isFunction(a.toHexString)&&(a=a.toHexString()),g(function(){b[d.modelName]=a})},this.setType=function(a){d=a,g(function(){c.color=e.getColor()})},e.setType(a)}function r(){return v?n():m()&&x.updateRecentWithNewColor(w.getColor()),!1}function s(){return o(),!1}function t(a){var b=13===a.keyCode,c=27===a.keyCode;return b?(h.done(),!1):c?(h.cancel(),!1):void 0}h.wixTextEditor=k;var u,v=!1;h.spectrum={options:{},color:void 0,isCustomize:!1},i=jQuery(i);var w=new q("font",h.wixTextEditor,h.spectrum),x=new p(w);a(h.spectrum.options,w),h.setTransparent=function(){w.setColor(null),h.spectrum.color="transparent"},h.toggleCustomize=function(a){var b=i.find(".clear-highlight-color-btn, .recent-colors, .sp-palette"),c=i.find(".sp-picker-container, .color-indicator"),d=h.spectrum.isCustomize&&_.isUndefined(a);1===_.size(arguments)&&_.isBoolean(a)?h.spectrum.isCustomize=a:h.spectrum.isCustomize=!h.spectrum.isCustomize,m()?(b.hide(),c.show()):(d&&x.updateRecentWithNewColor(w.getColor()),c.hide(),b.show())},h.cancel=function(){v=!0,l()},h.done=l,i.on(b.HIDE_DROPDOWN_EVENT,r),i.on(b.SHOW_DROPDOWN_EVENT,s),i.on("keydown",t),h.$on("$destroy",function(){i.off(b.HIDE_DROPDOWN_EVENT,r),i.off(b.SHOW_DROPDOWN_EVENT,s),i.off("keydown",t)})}return{restrict:"E",require:"^wTextEditor",templateUrl:"modules/wixTextEditor/colorPicker/wixColorPickerTemplate.html",scope:{modelName:"@",defaultVal:"@",showClear:"@"},link:{pre:h}}}b.$inject=["wDropdownManager","$window","$timeout"],angular.module("wixTextEditor").directive("wColorPicker",b).directive("wColorForeground",function(){return{restrict:"E",template:'<w-color-picker class="font-color" model-name="colorFont" default-val="#000000"></w-color-picker>'}}).directive("wColorBackground",function(){return{restrict:"E",template:'<w-color-picker class="background-color" model-name="colorHighlight" default-val="transparent" show-clear="true"></w-color-picker>'}});var c="wix_text_editor_spectrum_color_palette",d=11,e="!#ffffff",f=[["#000000","#666666","#b5b5b5","#ffffff","#0e9553","#6fa33f","#cccd2a","#cc8823","#ce5028","#cb2026","#a0206a","#89298d","#502b7b"],["#3a3091","#213f92","#213f95","#0957a2","#15a95f","#6abd47","#f3ec18","#fcba28","#f57b2f","#ec4f84","#cf4e9e","#b16faf","#824f9e"]],g={showPalette:!0,showPaletteOnly:!1,showSelectionPalette:!1,palette:f,allowEmpty:!1,showButtons:!1,showInput:!0,showAlpha:!1,showInitial:!0,preferredFormat:"hex",hideAfterPaletteSelect:!0,flat:!0,containerClassName:"colorpicker-popup-container",replacerClassName:"colorpicker-dropdown-btn-container",appendTo:".colorpicker-container"}}(),function(){function a(a,b){a.spectrum(b);var d=a.spectrum.bind(a),e={};return e.on=a.on.bind(a),e.trigger=a.trigger.bind(a),c.forEach(function(a){e[a]=_.partial(d,a)}),e.inputElement=a,e}function b(b){return{restrict:"E",require:"ngModel",scope:{options:"="},template:'<input type="text">',link:function(c,f,g,h){function i(){var a=i._element;return a&&a.length||(i._element=jQuery(f.find("input.sp-input")),a=i._element),a}function j(a){a&&(a=_.isString(a)?a:a.toHexString()),h.$setViewValue(a||"")}function k(){var a=i().val()||"";e.test(a)&&(a="#"===a.charAt(0)?a:"#"+a,b(function(){l.set(a||""),j(a),l.trigger("move.spectrum",l.get())}))}var l,m=jQuery(f.find("input").hide()),n={};d.forEach(function(a){n[a]=function(b){j(b);var d=c.options&&c.options[a];return angular.isFunction(d)?d(b):void 0}});var o=angular.extend({},c.options,n);l=new a(m,o),h.$render=function(){l.set(h.$viewValue||"")},angular.isDefined(o.color)&&b(function(){l.set(o.color||""),j(o.color)}),angular.isFunction(o.onInitialized)&&(o.onInitialized(l),i().on("input",k)),c.$on("$destroy",function(){i().off("input",k),l.destroy()})}}}b.$inject=["$timeout"],angular.module("wixTextEditor").directive("wSpectrum",b);var c=["show","hide","toggle","get","set","container","reflow","destroy","enable","disable","option"],d=["change","move","hide","show"],e=/(^#?[0-9A-F]{6}$)/i}(),function(){function a(a,c){return{restrict:"E",require:"^wTextEditor",scope:!0,template:'<w-toolbar-dropdown extra-class="smileys-dropdown"><img ng-repeat="item in items" ng-src="{{item}}" ng-click="insertSmiley(item);" width="22" height="22"/></w-toolbar-dropdown>',link:{pre:function(d,e,f,g){d.textEditorCtrl=g,d.items=b,d.insertSmiley=function(b){var d=a.getCKEditor(g.editorId);d.insertHtml('<img width="22" height="22" src="'+b+'"/>');var e=d.getSelection();e&&e.removeAllRanges(),c.hideAll()}}}}}a.$inject=["wTextEditorService","wDropdownManager"],angular.module("wixTextEditor").directive("wSmileys",a);var b=["7fe0c22151324d13926ffbc0214544c8.png_256","7b04010e31c94882b2998f12deef8af7.png_256","404595ac4cd743d78655fd5bf69dcee6.png_256","35f55a9287264fd597cc760132cefbd6.png_256","f08e343127774efe8d9971ba20f4b6e6.png_256","c812a646f00a4a9eb04d1d8f44771c57.png_256","3e7ee5aee11248989143650c9d1e3ee2.png_256","a99ac5beed3d414199c2f7e3dde91c4d.png_256","7cc7ce17ab574c7d80c16300d319759d.png_256","5e8d4aad3d8d4ee1a84d60c9f939c7c4.png_256","18442bd62d504016b4957df98d0e9947.png_256","edffb86884d14dc8a2c1a1d8b99f708f.png_256","6dacfc85007e458c8ae20bc859ca4add.png_256","05cf9acaaf89423c9b999523d877220f.png_256","19da577ba0424632a53b6af3d5e36333.png_256","9a64103b53874531b95db7cfdeadb8a6.png_256","4e761513980f4ced8ba00612716210b6.png_256","2fdefdb0908942f0824121611fdeab91.png_256","f25423271ca54aa7b56ea48d92e3e477.png_256","5253abf8b8724ca48472a5b8641e728c.png_256","86da919dbf854f70bc6ec340e9bdd06b.png_256","8648a9528ac3477180811ff3a3af759d.png_256","9f790ee2616e4dc0b4a94a66d6b7a604.png_256","d0afae780ee343318e18349a44fa128e.png_256","21135c3fd8a74930a55bbde71e4893c9.png_256","93fc19dd319f400397db40bc6b7bfe94.png_256","8abde7f0c2a3452e9dffd800f3b0f0c3.png_256","bc3f2f34e6d642d9875525532326d997.png_256","39226cacde0d4a9c90ef7ad8e8416848.png_256","460af95cc2094bc6879c520de6b7f8a4.png_256","c5272b450d59436cbb8bb750eb0bb3cb.png_256","415a582924c149deb4aa09f50d40e861.png_256","bbb9a23c29c9407f8a31e2fc45adead6.png_256","9723c50edf894693acf284c7bda5f12d.png_256","bb86954989384b68a87d253b371b8560.png_256","64f92d85b9bf4013b4523e8ac7887f5d.png_256","b2f1959433b8433297ffc33b60546bdf.png_256","0331e1a27e9a4586abefeb331e65940a.png_256","8b7424d0c625450580ed1e08472208f6.png_256","0769ff30a359428f90b3864c78f4b682.png_256","3509e29d40d24b53b9ea6064d03de5c0.png_256","6047ac2b0fe24f88bcf6fa54fdde792e.png_256","e7b312c9917c48588e7c19d9a8430b55.png_256","fb061817cf22429fbddf4be5dc4975f6.png_256","8dbd61b98f9d43f9993a2e2d9c0785c4.png_256","afb2dbc907e24fc2b83bae327fe75ee6.png_256","2bde30493a4e4413b4f8f2e84968a211.png_256","12108ff02701476dbe135ec1cc67bbe6.png_256"].map(function(a){return"https://static.wixstatic.com/media/5e9922_"+a})}(),function(){function a(a,b){return{restrict:"E",require:"^wTextEditor",scope:!0,templateUrl:"modules/wixTextEditor/directives/wixLinkDirectiveTemplate.html",link:function(e,f,g,h){function i(a,b){a.stopPropagation(),13===a.which&&(e.addLink(b),a.preventDefault())}function j(c){if(e.data.hasError=!m(c),e.data.hasError)n();else if(b.hideAll(),c){var d=a.getCKEditor(h.editorId),f=o(c);d.execCommand("wixLink",{href:f,"data-cke-saved-href":f,target:"_blank"}),e.$eval(g.underline)!==!1&&1!==d.getCommand("underline").state&&d.execCommand("underline")}else l("wixUnlink")}function k(){e.data.link=h.link||"",e.data.hasError=!1,n()}function l(b,c){a.getCKEditor(h.editorId).execCommand(b,c)}function m(a){return a?c.test(a):!0}function n(){e.$broadcast("focusOn","wixLink")}function o(a){return d.test(a)?a:"http://"+a}e.textEditorCtrl=h,e.data={link:"",hasError:!1},e.cancel=b.hideAll,e.initialize=k,e.addLink=j,e.addLinkOnEnter=i}}}function b(a){return{restrict:"E",require:"^wTextEditor",scope:!0,template:'<div class="button unlink" ng-click="unlink()"><div class="img-icon button-with-text"></div></div>',link:function(b,c,d,e){b.unlink=function(){a.getCKEditor(e.editorId).execCommand("wixUnlink")}}}}a.$inject=["wTextEditorService","wDropdownManager"],b.$inject=["wTextEditorService"],angular.module("wixTextEditor").directive("wLink",a).directive("wUnlink",b);var c=/((https?|ftp)\:\/\/)?([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?(([a-z0-9-.]*)\.([a-z]{2,6}))|(([0-9]{1,3}\.){3}[0-9]{1,3})(\:[0-9]{2,5})?(\/([a-z0-9+\$_-]\.?)+)*\/?(\?[a-z+&\$_.-][a-z0-9;:@&%=+\/\$_.-]*)?(#[a-z_.-][a-z0-9+\$_.-]*)?/i,d=/^(http:\/\/|https:\/\/|mailto:)/i}(),function(){function a(){return{restrict:"E",scope:!0,template:'<div class="region-btn save" ng-click="save($event)"><i class="composer-ic-vi"></i></div>',link:function(a){a.save=function(b){b.stopPropagation(),a.$emit("region-save")}}}}function b(){return{restrict:"E",scope:!0,template:'<div class="region-btn region-btn-danger cancel" ng-click="cancel($event)"><i class="composer-ic-cancel"></i></div>',link:function(a){a.cancel=function(b){b.stopPropagation(),a.$emit("region-cancel")}}}}angular.module("wixTextEditor").directive("wToolbarSave",a).directive("wToolbarCancel",b)}(),function(){function b(b,c,d){function e(){var a=d[0];a.designMode="on",a.execCommand&&(a.execCommand("enableObjectResizing",!1,!1),a.execCommand("enableInlineTableEditing",!1,!1)),a.designMode="off"}function f(a){return function(b){"table"===b.data.name&&a(b,b.data.definition.getContents("info"))}}function g(a,b,c){b&&b.limit&&Number.isInteger(b.limit)&&(a.maxValue=b.limit,a.validationMessage=b.message,a.validate=c)}var h=function(){var a=this.getValue(),b=!!(Number.isInteger(parseInt(a))&&a>0);return b=b&&a<this.maxValue,b||(c.alert(this.validationMessage),this.select()),b};return{restrict:"E",require:"^wTextEditor",template:'<w-button btn-img-class="table" extra-class="table" custom-click="createTable"></w-button>',scope:{config:"="},link:{pre:function(d,i,j,k){e();var l=c._.once(function(){a.on("dialogDefinition",f(function(a,b){var c=d.config||{};(c.remove||[]).forEach(function(a){b.remove(a)}),(c.hide||[]).forEach(function(a){b.get(a).hidden=!0}),c.validation&&(g(b.get("txtRows"),c.validation.rows,h),g(b.get("txtCols"),c.validation.columns,h))}))});d.createTable=function(){l();var a=b.getCKEditor(k.editorId);a.execCommand("table")}}}}}b.$inject=["wTextEditorService","$window","$document"],angular.module("wixTextEditor").directive("wTable",b),Number.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a}}();try{angular.module("ck-editor-angular-preload")}catch(b){angular.module("ck-editor-angular-preload",[])}angular.module("ck-editor-angular-preload").run(["$templateCache",function(a){a.put("modules/wixTextEditor/colorPicker/wixColorPickerTemplate.html",'<w-toolbar-dropdown img-class="colorpicker" update-event="fontColor" no-arrow="true">\n    <div class="colorpicker-container" ng-class="{\'customize-active\': spectrum.isCustomize}">\n        <div class="colorpicker-nav-tabs clearfix">\n          <span class="button button-clean button-medium positive button-with-text cp-customize" ng-click="toggleCustomize()" ng-class="{\'active\': spectrum.isCustomize}">{{\'CK.EDITOR.NG.COMMON.CUSTOMIZE\' | translate}}</span>\n        </div>\n        <div class="color-indicator" ng-style="{\'background-color\': spectrum.color}"></div>\n        <w-spectrum options="spectrum.options" ng-model="spectrum.color"></w-spectrum>\n        <span class="clear-highlight-color-btn" ng-click="setTransparent()" ng-if="showClear"></span>\n        <div class="recent-colors sp-palette"></div>\n        <div class="confirmation-actions">\n          <a class="wix-button is-button-small" ng-click="done()">{{\'CK.EDITOR.NG.COMMON.OK\' | translate}}</a>\n          <a class="wix-button-danger is-button-small" ng-click="cancel()">{{\'CK.EDITOR.NG.COMMON.CANCEL\' | translate}}</a>\n        </div>\n    </div>\n</w-toolbar-dropdown>\n')}]);try{angular.module("ck-editor-angular-preload")}catch(b){angular.module("ck-editor-angular-preload",[])}angular.module("ck-editor-angular-preload").run(["$templateCache",function(a){a.put("modules/wixTextEditor/directives/wixLinkDirectiveTemplate.html",'<w-toolbar-dropdown img-class="link" extra-class="link" update-event="link" on-open="initialize()" no-arrow="true">\n  <div class="clearfix">\n    <div class="link-controls">\n      <input type="text" ng-model="data.link" class="so-input-medium" focus-on="wixLink" ng-keydown="addLinkOnEnter($event, data.link)" placeholder="www.google.com">\n    </div>\n    <a class="wix-button is-button-small" ng-click="addLink(data.link)">{{\'CK.EDITOR.NG.COMMON.OK\' | translate}}</a>\n    <a class="wix-button-danger is-button-small" ng-click="cancel()">{{\'CK.EDITOR.NG.COMMON.CANCEL\' | translate}}</a>\n  </div>\n  <div class="error" ng-if="data.hasError">{{\'CK.EDITOR.NG.ERRORS.WRONG_URL\' | translate}}</div>\n</w-toolbar-dropdown>\n')}]);try{angular.module("ck-editor-angular-preload")}catch(b){angular.module("ck-editor-angular-preload",[])}angular.module("ck-editor-angular-preload").run(["$templateCache",function(a){a.put("modules/wixTextEditor/directives/wixToolbarDropdownTemplate.html",'<div class="popup-btn button" ng-click="togglePopup()" ng-class="{\'no-arrow\': noArrow !== undefined}">\n    <div class="img-icon button-with-text"></div>\n    <div ng-show="noArrow == undefined" class="arrow"></div>\n</div>\n<div class="popup-inner-content" ng-transclude></div>\n')}])}(window.CKEDITOR_NG);